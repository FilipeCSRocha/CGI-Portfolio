<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Filipe Rocha — CGI Portfolio</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    html{scroll-behavior:smooth}
    body{background:#0a0f12;color:#fff;margin:0}
    ::-webkit-scrollbar{width:12px;height:12px}
    ::-webkit-scrollbar-track{background:rgba(255,255,255,.03)}
    ::-webkit-scrollbar-thumb{background:rgba(255,255,255,.15);border-radius:8px}
    ::-webkit-scrollbar-thumb:hover{background:rgba(255,255,255,.25)}
    *{scrollbar-width:thin;scrollbar-color:rgba(255,255,255,.25) rgba(255,255,255,.05)}
    #fx{position:fixed; inset:0; width:100%; height:100%; pointer-events:none; z-index:0}
    .btn{border:1px solid rgba(255,255,255,.15); background:rgba(255,255,255,.06); padding:.5rem 1rem; border-radius:.75rem}
    .btn:hover{background:rgba(255,255,255,.12)}
    .thumb{ filter:grayscale(80%); transition:transform .5s ease, filter .35s ease, opacity .35s ease; }
    .group:hover .thumb{ filter:grayscale(30%); transform:scale(1.04); }
  </style>
</head>
<body class="min-h-screen selection:bg-cyan-300/20">
  <!-- Background particles -->
  <canvas id="fx"></canvas>

  <!-- HERO -->
  <section class="relative z-10 h-[90svh] overflow-hidden">
    <video id="heroVideo" class="absolute inset-0 h-full w-full object-cover opacity-55" src="https://cdn.coverr.co/videos/coverr-modern-interior-8050/1080p.mp4" autoplay muted playsinline loop style="z-index:0"></video>
    <div class="relative z-10 flex h-full items-center justify-center">
      <div class="mx-4 w-full max-w-3xl rounded-3xl border border-white/10 bg-white/5 p-10 text-center backdrop-blur-xl shadow-[0_0_80px_rgba(0,0,0,0.45)]">
        <h1 class="text-4xl md:text-6xl font-semibold tracking-tight">Filipe Rocha</h1>
        <p class="mt-3 text-lg md:text-xl text-white/80">CGI Artist</p>
        <div class="mt-8 flex items-center justify-center gap-3">
          <a href="#portfolio" class="rounded-xl bg-cyan-400/20 px-5 py-2.5 text-base border border-cyan-300/30 hover:bg-cyan-300/30">View My Work</a>
          <a href="#contact" class="rounded-xl bg-white/5 px-5 py-2.5 text-base border border-white/10 hover:bg-white/10">Contact</a>
        </div>
      </div>
    </div>
    <div class="pointer-events-none absolute inset-0 bg-gradient-to-b from-black/20 via-transparent to-black/60"></div>
  </section>

  <!-- ABOUT -->
  <section id="about" class="relative z-10 mx-auto max-w-6xl px-6 py-20">
    <h2 class="mb-6 text-2xl md:text-3xl font-semibold tracking-tight">About Me</h2>
    <div class="grid gap-8 md:grid-cols-[1fr_1.6fr] items-start">
      <div class="flex justify-center">
        <div class="relative w-48 h-48 md:w-56 md:h-56 rounded-full overflow-hidden border border-white/10 shadow-[0_0_40px_rgba(160,240,255,0.25)]">
          <img src="Media/images/Profile.jpg" alt="Filipe Rocha" class="h-full w-full object-cover" />
        </div>
      </div>
      <div class="space-y-8">
        <div class="rounded-2xl border border-white/10 bg-white/5 p-6 leading-relaxed text-white/85 backdrop-blur">
          I’m a CGI artist experienced in design and architectural visualization for marketing.
          I deliver photo-real stills and animations, covering modeling, materials, lighting, rendering, compositing and editing.
        </div>

        <!-- Tools (DISABLED to avoid 404 noise; we can re-enable with a manifest later)
        <div class="rounded-2xl border border-white/10 bg-white/5 p-6 backdrop-blur">
          <h3 class="mb-4 font-medium text-white/90">Tools</h3>
          <div id="toolIcons" class="grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 gap-3"></div>
          <p id="toolHint" class="mt-3 text-xs text-white/50">Add icons when ready.</p>
        </div>
        -->
      </div>
    </div>
  </section>

  <!-- PORTFOLIO -->
  <section id="portfolio" class="relative z-10 mx-auto max-w-6xl px-6 py-20">
    <h2 class="mb-6 text-2xl md:text-3xl font-semibold tracking-tight">Portfolio</h2>
    <div id="gallery" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5"></div>
    <div id="galleryActions" class="mt-8 flex justify-center">
      <button id="toggleImages" class="btn">Show more</button>
    </div>
  </section>

  <!-- VIDEOS -->
  <section id="videos" class="relative z-10 mx-auto max-w-6xl px-6 py-20">
    <h2 class="mb-6 text-2xl md:text-3xl font-semibold tracking-tight">Videos</h2>
    <div id="videoGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5"></div>
    <div id="videoActions" class="mt-8 flex justify-center">
      <button id="toggleVideos" class="btn">Show more</button>
    </div>
    <div id="vidLightbox" class="fixed inset-0 z-[9999] hidden">
      <div class="absolute inset-0 bg-black/90"></div>
      <div class="relative h-full w-full flex items-center justify-center p-4">
        <button id="vlbClose" class="absolute top-4 right-4 btn">✕ Close</button>
        <button id="vlbPrev" class="absolute left-4 top-1/2 -translate-y-1/2 btn">⟵ Prev</button>
        <button id="vlbNext" class="absolute right-4 top-1/2 -translate-y-1/2 btn">Next ⟶</button>
        <video id="vlbVideo" src="" class="block max-w-[92vw] max-h-[90vh] rounded-2xl border border-white/10 shadow-[0_0_40px_rgba(0,0,0,0.5)]" controls playsinline></video>
      </div>
    </div>
  </section>

  <!-- RESUME -->
  <section id="resume" class="relative z-10 mx-auto max-w-6xl px-6 pb-24">
    <h2 class="mb-6 text-2xl md:text-3xl font-semibold tracking-tight">Resume</h2>
    <div class="rounded-2xl border border-white/10 bg-white/5 p-6 backdrop-blur">
      <ul class="space-y-5">
        <li class="grid gap-2 md:grid-cols-[1.2fr_1fr]">
          <div>
            <div class="text-white/95 font-medium">CGI Artist</div>
            <div class="text-white/70 text-sm">Trident Marketing Anglia Ltd · Ipswich, UK</div>
          </div>
          <div class="text-white/60 text-sm md:text-right">Feb 2022 – Present</div>
        </li>
        <li class="grid gap-2 md:grid-cols-[1.2fr_1fr]">
          <div>
            <div class="text-white/95 font-medium">3D Visualiser (Freelance)</div>
            <div class="text-white/70 text-sm">London, UK</div>
          </div>
          <div class="text-white/60 text-sm md:text-right">Jul 2020 – Feb 2022</div>
        </li>
      </ul>
    </div>
  </section>

  <!-- CONTACT -->
  <footer id="contact" class="relative z-10 border-t border-white/10 bg-white/5">
    <div class="mx-auto max-w-6xl px-6 py-12">
      <div class="grid gap-4 md:grid-cols-2 items-center">
        <div>
          <h3 class="text-xl font-semibold">Let’s work together</h3>
          <p class="text-white/70">Available for freelance and collaboration.</p>
        </div>
        <div class="flex justify-start md:justify-end gap-3">
          <a class="btn" href="mailto:hello@example.com">Email</a>
          <a class="btn" href="https://www.linkedin.com/in/filipecsrocha/" target="_blank" rel="noreferrer">LinkedIn</a>
          <a class="btn" href="#">ArtStation</a>
          <a class="btn" href="#">Vimeo</a>
        </div>
      </div>
      <p class="mt-6 text-xs text-white/50">© <span id="year"></span> Filipe Rocha. All rights reserved.</p>
    </div>
  </footer>

  <!-- IMAGE LIGHTBOX -->
  <div id="lightbox" class="fixed inset-0 hidden" style="z-index:2147483647;">
    <div class="absolute inset-0 bg-black/90"></div>
    <div class="relative h-full w-full flex items-center justify-center p-4">
      <button id="lbClose" class="absolute top-4 right-4 btn">✕ Close</button>
      <button id="lbPrev" class="absolute left-4 top-1/2 -translate-y-1/2 btn">⟵ Prev</button>
      <button id="lbNext" class="absolute right-4 top-1/2 -translate-y-1/2 btn">Next ⟶</button>
      <img id="lbImg" src="" alt="" class="block max-w-[92vw] max-h-[90vh] object-contain rounded-2xl border border-white/10 shadow-[0_0_40px_rgba(0,0,0,0.5)]" />
    </div>
  </div>

<script>
  // Year
  document.getElementById('year').textContent = new Date().getFullYear();

  /* ===== Simple helper: fetch JSON with 404-safe handling ===== */
  async function fetchJSON(url){
    try{
      const r = await fetch(url, {cache:'no-store'});
      if (!r.ok) return null;
      return await r.json();
    }catch{ return null; }
  }

  /* ================= BACKGROUND PARTICLES ================= */
  (function(){
    var canvas = document.getElementById('fx');
    var ctx = canvas.getContext('2d');
    var DPR = window.devicePixelRatio || 1;
    var PARTICLE_RADIUS = 6, COUNT = 12, BASE_RADIUS = 220, STIFFNESS = 15.0, DAMPING = 0.88, SWIRL = 2, LINK_DIST = 190, GRID_ALPHA = 0.055, GRID_SPACING = 96, NOISE = 180, CLICK_IMPULSE = 1200;
    var anchor = { x: window.innerWidth * 0.5, y: window.innerHeight * 0.45 };
    var mouse  = { x: anchor.x, y: anchor.y, active: false };
    var pts = [], state = { scatter: 0.2 };

    var glow = document.createElement('canvas');
    (function buildGlow(){
      var r = PARTICLE_RADIUS;
      glow.width = glow.height = r * DPR * 2;
      var g = glow.getContext('2d');
      g.setTransform(DPR,0,0,DPR,0,0);
      var grad = g.createRadialGradient(r,r,0,r,r,r);
      grad.addColorStop(0,'rgba(160,240,255,0.95)');
      grad.addColorStop(1,'rgba(160,240,255,0)');
      g.fillStyle = grad; g.beginPath(); g.arc(r,r,r,0,Math.PI*2); g.fill();
    })();

    function size(){
      var cssW = Math.max(1, Math.floor(window.innerWidth));
      var cssH = Math.max(1, Math.floor(window.innerHeight));
      canvas.width  = cssW * DPR; canvas.height = cssH * DPR;
      ctx.setTransform(DPR,0,0,DPR,0,0);
    }
    function spawn(){
      var cw = Math.max(1, Math.floor(window.innerWidth));
      var ch = Math.max(1, Math.floor(window.innerHeight));
      pts.length = 0;
      for (var i=0; i<COUNT; i++){
        var sx, sy, edge = Math.floor(Math.random()*4);
        if (edge===0){ sx = -20; sy = Math.random()*ch; }
        if (edge===1){ sx = cw+20; sy = Math.random()*ch; }
        if (edge===2){ sx = Math.random()*cw; sy = -20; }
        if (edge===3){ sx = Math.random()*cw; sy = ch+20; }
        var a = Math.random()*Math.PI*2;
        var r = (0.4 + Math.random()*0.6) * BASE_RADIUS;
        var toAx = anchor.x - sx, toAy = anchor.y - sy;
        var dist = Math.hypot(toAx,toAy) || 1;
        var iv = 180 + Math.random()*180;
        pts.push({ x: sx, y: sy, vx: (toAx/dist)*iv, vy: (toAy/dist)*iv, homeA: a, homeR: r, swirl: (0.3+Math.random()*0.7)*SWIRL });
      }
    }
    function onMove(e){ mouse.x = e.clientX; mouse.y = e.clientY; mouse.active = true; }
    function onLeave(){ mouse.active = false; }
    function onClick(e){
      var cx = e.clientX, cy = e.clientY; state.scatter = Math.min(1.5, state.scatter + 1.0);
      for (var i=0;i<pts.length;i++){
        var p=pts[i], dx = p.x - cx, dy = p.y - cy, d = Math.hypot(dx,dy) + 0.001, uX = dx/d, uY = dy/d;
        var impulse = CLICK_IMPULSE * (0.6 + 0.4*Math.random()); p.vx += uX*impulse; p.vy += uY*impulse;
      }
    }
    var footerEl = document.getElementById('contact');
    function getFade(){
      if (!footerEl) return 1;
      var rect = footerEl.getBoundingClientRect();
      var vh = window.innerHeight || document.documentElement.clientHeight;
      var start = vh, end = vh * 0.4;
      if (rect.top >= start) return 1;
      if (rect.top <= end) return 0;
      return (rect.top - end) / (start - end);
    }
    var last = performance.now();
    function loop(now){
      var dt = Math.min(0.05, (now - last) / 1000); last = now;
      var cw = Math.max(1, Math.floor(window.innerWidth));
      var ch = Math.max(1, Math.floor(window.innerHeight));
      var kAnchor = 12, tx = mouse.active ? mouse.x : anchor.x, ty = mouse.active ? mouse.y : anchor.y;
      anchor.x += (tx - anchor.x) * Math.min(1, kAnchor*dt);
      anchor.y += (ty - anchor.y) * Math.min(1, kAnchor*dt);
      if (state.scatter > 0) state.scatter = Math.max(0, state.scatter - 1.2*dt);
      ctx.clearRect(0, 0, cw, ch);
      var fade = getFade(); ctx.save(); ctx.globalAlpha = fade;

      // Grid
      ctx.save(); ctx.globalAlpha *= 0.055; ctx.lineWidth = 1; ctx.strokeStyle = '#7fd0ff';
      var ox = ((anchor.x/cw)-0.5)*8, oy = ((anchor.y/ch)-0.5)*8;
      for (var x = (ox % 96) - 96; x < cw + 96; x += 96){ ctx.beginPath(); ctx.moveTo(x,0); ctx.lineTo(x,ch); ctx.stroke(); }
      for (var y = (oy % 96) - 96; y < ch + 96; y += 96){ ctx.beginPath(); ctx.moveTo(0,y); ctx.lineTo(cw,y); ctx.stroke(); }
      ctx.restore();

      // Update + draw
      var damping = Math.pow(0.88, dt*60);
      for (var i=0;i<pts.length;i++){
        var p=pts[i]; p.homeA += p.swirl * 0.3 * dt;
        var targetR = p.homeR * (1 + state.scatter*1.4);
        var px = anchor.x + Math.cos(p.homeA) * targetR;
        var py = anchor.y + Math.sin(p.homeA) * targetR;
        var ax = (px - p.x) * 15.0 + (Math.random()-0.5) * 180 * dt;
        var ay = (py - p.y) * 15.0 + (Math.random()-0.5) * 180 * dt;
        p.vx = (p.vx + ax * dt) * damping; p.vy = (p.vy + ay * dt) * damping;
        p.x += p.vx * dt; p.y += p.vy * dt;
      }
      for (var i=0;i<pts.length;i++){
        var p=pts[i];
        ctx.drawImage(glow, (p.x - 6), (p.y - 6), 12, 12);
        for (var j=i+1;j<pts.length;j++){
          var q=pts[j], dx=p.x-q.x, dy=p.y-q.y, d=Math.hypot(dx,dy);
          if (d<190){ var a=(1-d/190)*0.6; ctx.strokeStyle='rgba(160,240,255,'+a+')'; ctx.lineWidth=0.8; ctx.beginPath(); ctx.moveTo(p.x,p.y); ctx.lineTo(q.x,q.y); ctx.stroke(); }
        }
      }
      ctx.restore(); requestAnimationFrame(loop);
    }
    function init(){
      window.addEventListener('resize', size, { passive:true });
      size(); spawn(); requestAnimationFrame(loop);
      window.addEventListener('mousemove', onMove, { passive:true });
      window.addEventListener('mouseleave', onLeave, { passive:true });
      window.addEventListener('click', onClick);
      var vid = document.getElementById('heroVideo');
      if (vid){ var p=vid.play(); if (p && p.catch) p.catch(function(){ vid.remove(); }); }
    }
    function size(){ var cssW=Math.max(1,Math.floor(window.innerWidth)); var cssH=Math.max(1,Math.floor(window.innerHeight)); canvas.width=cssW*DPR; canvas.height=cssH*DPR; ctx.setTransform(DPR,0,0,DPR,0,0); }
    init();
  })();

  /* ================= IMAGES via MANIFEST (fallback: light probe) ================= */
  (function(){
    var galleryEl = document.getElementById('gallery');
    var toggleBtn = document.getElementById('toggleImages');
    var lb = document.getElementById('lightbox'), lbImg = document.getElementById('lbImg');
    var lbClose = document.getElementById('lbClose'), lbPrev = document.getElementById('lbPrev'), lbNext = document.getElementById('lbNext');

    var PAGE_SIZE = 6;
    var imageList = []; // {thumb, full}
    var expanded = false;
    var current = 0;

    function makeCard(entry, idx){
      var btn = document.createElement('button');
      btn.className = "group relative aspect-[4/3] overflow-hidden rounded-2xl border border-white/10 bg-white/5 focus:outline-none";
      btn.setAttribute('data-index', idx);
      var img = document.createElement('img');
      img.src = "Media/images/" + entry.thumb;
      img.loading = "lazy"; img.decoding="async"; img.fetchPriority="low";
      img.alt = ""; img.className = "thumb h-full w-full object-cover";
      img.onerror = function(){ btn.remove(); };
      var glow = document.createElement('div');
      glow.className = "pointer-events-none absolute inset-0 opacity-0 group-hover:opacity-100 transition duration-300 bg-gradient-to-tr from-cyan-300/10 via-transparent to-transparent";
      var badge = document.createElement('div');
      badge.className = "pointer-events-none absolute inset-0 flex items-end justify-end p-3 opacity-0 group-hover:opacity-100 transition";
      var badgeSpan = document.createElement('span');
      badgeSpan.className = "rounded-full border border-white/30 bg-black/30 backdrop-blur px-2 py-0.5 text-xs";
      badgeSpan.textContent = "View";
      badge.appendChild(badgeSpan);
      btn.appendChild(img); btn.appendChild(glow); btn.appendChild(badge);
      btn.addEventListener('click', function(){ openLightbox(idx); });
      return btn;
    }

    function render(){
      galleryEl.innerHTML = "";
      var total = imageList.length;
      var toShow = expanded ? total : Math.min(PAGE_SIZE, total);
      for (var i=0;i<toShow;i++){ galleryEl.appendChild(makeCard(imageList[i], i)); }
      toggleBtn.textContent = expanded ? "Show less" : "Show more";
      document.getElementById('galleryActions').classList.toggle('hidden', total <= PAGE_SIZE);
    }

    function openLightbox(idx){
      current = idx;
      lbImg.src = "Media/images/" + imageList[current].full;
      lb.classList.remove('hidden');
      document.body.style.overflow = "hidden";
    }
    function closeLightbox(){ lb.classList.add('hidden'); document.body.style.overflow = ""; }
    function show(delta){
      current = (current + delta + imageList.length) % imageList.length;
      lbImg.src = "Media/images/" + imageList[current].full;
    }
    lbClose.addEventListener('click', closeLightbox);
    lb.addEventListener('click', function(e){ if(e.target === lb || e.target.classList.contains('bg-black/90')) closeLightbox(); });
    lbPrev.addEventListener('click', function(){ show(-1); });
    lbNext.addEventListener('click', function(){ show(1); });
    window.addEventListener('keydown', function(e){
      if (lb.classList.contains('hidden')) return;
      if (e.key === 'Escape') closeLightbox();
      if (e.key === 'ArrowLeft') show(-1);
      if (e.key === 'ArrowRight') show(1);
    });
    toggleBtn.addEventListener('click', function(){ expanded = !expanded; render(); });

    async function initFromManifest(){
      var m = await fetchJSON('Media/images/manifest.json');
      if (!m || !Array.isArray(m.items)) return false;
      // Validate and normalize paths (avoid 404s)
      imageList = m.items
        .filter(function(it){ return it && typeof it.thumb==='string' && typeof it.full==='string'; });
      return imageList.length > 0;
    }

    async function initFallbackLightProbe(){
      // If no manifest: try a **short** predictable series (01..18) and stop on first miss streak.
      var EXTS = ["webp","jpg","jpeg","png"];
      var MAX_N = 18;            // small cap to avoid noise
      var MISS_STREAK_STOP = 3;  // stop quickly
      var misses = 0;

      function probe(url){
        return new Promise(function(res){
          var im = new Image();
          im.onload = function(){ res(true); };
          im.onerror = function(){ res(false); };
          im.src = url;
        });
      }

      for (var i=1;i<=MAX_N;i++){
        var n2 = String(i).padStart(2,'0');
        var found = null;
        for (var e=0;e<EXTS.length;e++){
          var ext = EXTS[e];
          var t = "Media/images/thumbs/" + n2 + "." + ext;
          var f = "Media/images/"       + n2 + "." + ext;
          /* eslint-disable no-await-in-loop */
          if (await probe(t) && await probe(f)){ found = {thumb: "thumbs/"+n2+"."+ext, full: n2+"."+ext}; break; }
        }
        if (found){ imageList.push(found); misses = 0; }
        else { misses++; if (misses >= MISS_STREAK_STOP) break; }
      }
      return imageList.length > 0;
    }

    (async function init(){
      var ok = await initFromManifest();
      if (!ok) ok = await initFallbackLightProbe();
      if (!ok){
        document.getElementById('portfolio').classList.add('hidden');
        return;
      }
      render();
    })();
  })();

  /* ================= VIDEOS via MANIFEST ONLY (no probing) ================= */
  (function(){
    var videoSection = document.getElementById('videos');
    var videoGrid = document.getElementById('videoGrid');
    var toggleBtn = document.getElementById('toggleVideos');
    var vlb = document.getElementById('vidLightbox'), vlbVideo = document.getElementById('vlbVideo');
    var vlbClose = document.getElementById('vlbClose'), vlbPrev = document.getElementById('vlbPrev'), vlbNext = document.getElementById('vlbNext');

    var PAGE = 6, expanded=false, current=0, videoList=[];

    function card(src, idx){
      var btn = document.createElement('button');
      btn.className = "group relative aspect-[4/3] overflow-hidden rounded-2xl border border-white/10 bg-white/5 focus:outline-none";
      btn.setAttribute('data-vidindex', idx);
      var vid = document.createElement('video');
      vid.src = "Media/Videos/" + src;
      vid.className = "thumb h-full w-full object-cover opacity-90";
      vid.muted = true; vid.loop = true; vid.playsInline = true;
      vid.oncanplay = function(){ vid.play().catch(function(){}); };
      vid.onerror = function(){ btn.remove(); };
      var badge = document.createElement('div');
      badge.className = "absolute inset-0 grid place-items-center pointer-events-none";
      var span = document.createElement('span');
      span.className = "rounded-full border border-white/50 bg-black/40 backdrop-blur px-3 py-1 text-sm";
      span.textContent = "▶ Play"; badge.appendChild(span);
      var glow = document.createElement('div');
      glow.className = "pointer-events-none absolute inset-0 opacity-0 group-hover:opacity-100 transition duration-300 bg-gradient-to-tr from-cyan-300/10 via-transparent to-transparent";
      btn.appendChild(vid); btn.appendChild(badge); btn.appendChild(glow);
      btn.addEventListener('click', function(){ openLightbox(idx); });
      return btn;
    }

    function render(){
      videoGrid.innerHTML = "";
      var toShow = expanded ? videoList.length : Math.min(PAGE, videoList.length);
      for (var i=0;i<toShow;i++){ videoGrid.appendChild(card(videoList[i], i)); }
      toggleBtn.textContent = expanded ? "Show less" : "Show more";
      document.getElementById('videoActions').classList.toggle('hidden', videoList.length <= PAGE);
    }

    function openLightbox(idx){
      current = idx;
      vlbVideo.src = "Media/Videos/" + videoList[current];
      vlb.classList.remove('hidden'); document.body.style.overflow = "hidden";
      vlbVideo.currentTime = 0; vlbVideo.play().catch(function(){});
    }
    function closeLightbox(){ vlb.classList.add('hidden'); document.body.style.overflow = ""; vlbVideo.pause(); vlbVideo.src = ""; }
    function show(delta){
      current = (current + delta + videoList.length) % videoList.length;
      vlbVideo.src = "Media/Videos/" + videoList[current]; vlbVideo.currentTime = 0; vlbVideo.play().catch(function(){});
    }
    vlbClose.addEventListener('click', closeLightbox);
    vlb.addEventListener('click', function(e){ if(e.target === vlb || e.target.classList.contains('bg-black/90')) closeLightbox(); });
    vlbPrev.addEventListener('click', function(){ show(-1); });
    vlbNext.addEventListener('click', function(){ show(1); });
    window.addEventListener('keydown', function(e){
      if (!vlb.classList.contains('hidden')) {
        if (e.key === 'Escape') closeLightbox();
        if (e.key === 'ArrowLeft') show(-1);
        if (e.key === 'ArrowRight') show(1);
      }
    });
    toggleBtn.addEventListener('click', function(){ expanded = !expanded; render(); });

    (async function init(){
      var m = await fetchJSON('Media/Videos/manifest.json');
      if (!m || !Array.isArray(m.items) || !m.items.length){
        // No videos -> hide section entirely
        videoSection.classList.add('hidden');
        return;
      }
      videoList = m.items.map(function(it){ return it.src; }).filter(Boolean);
      render();
    })();
  })();
</script>
</body>
</html>
